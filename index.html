<!DOCTYPE html>
<html lang="en-us">
  <head>
    <meta charset="UTF-8">
    <title>Couchdb-Promises by pmorjan</title>
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <link rel="stylesheet" type="text/css" href="stylesheets/normalize.css" media="screen">
    <link href='https://fonts.googleapis.com/css?family=Open+Sans:400,700' rel='stylesheet' type='text/css'>
    <link rel="stylesheet" type="text/css" href="stylesheets/stylesheet.css" media="screen">
    <link rel="stylesheet" type="text/css" href="stylesheets/github-light.css" media="screen">
  </head>
  <body>
    <section class="page-header">
      <h1 class="project-name">couchdb-promises</h1>
      <h2 class="project-tagline">Yet another Node module for CouchDB that uses ES6 promises.</h2>
      <a href="https://github.com/pmorjan/couchdb-promises" class="btn">View on GitHub</a>
      <a href="https://www.npmjs.com/package/couchdb-promises" class="btn">View on NPM</a>
    </section>

    <section class="main-content">
      <p><a href="http://standardjs.com/"><img src="https://img.shields.io/badge/code%20style-standard-brightgreen.svg" alt="JavaScript Style Guide"></a>
<a href="https://travis-ci.org/pmorjan/couchdb-promises"><img src="https://travis-ci.org/pmorjan/couchdb-promises.svg?branch=master" alt="Build Status"></a>
<a href="https://www.npmjs.com/package/couchdb-promises"><img src="https://img.shields.io/npm/v/couchdb-promises.svg" alt="NPM Version"></a></p>

<h1>
<a id="couchdb-promises" class="anchor" href="#couchdb-promises" aria-hidden="true"><span aria-hidden="true" class="octicon octicon-link"></span></a>couchdb-promises</h1>

<h3>
<a id="yet-another-nodejs-module-for-couchdb-that-uses-es6-promises" class="anchor" href="#yet-another-nodejs-module-for-couchdb-that-uses-es6-promises" aria-hidden="true"><span aria-hidden="true" class="octicon octicon-link"></span></a>Yet another Node.js module for CouchDB that uses ES6 promises</h3>

<ul>
<li>  <strong>no dependencies</strong>
</li>
<li>  <strong>as simple as possible</strong>
</li>
</ul>

<p>All Functions return a <strong>Promise object</strong> whose fulfillment or failure handler receives an object of <strong>5</strong> properties:</p>

<ul>
<li>  <strong>headers</strong>: {Object} - HTTP response headers from CouchDB</li>
<li>  <strong>data</strong>: {Object} - CouchDB response body</li>
<li>  <strong>status</strong>: {Number} - HTTP status code from CouchDB</li>
<li>  <strong>message</strong>: {String} - description of the status code from CouchDB API</li>
<li>  <strong>duration</strong>: {Number} - execution time in milliseconds</li>
</ul>

<p>The promise is resolved if the <strong>status</strong> code is <strong>&lt; 400</strong> otherwise rejected.</p>

<h3>
<a id="installation" class="anchor" href="#installation" aria-hidden="true"><span aria-hidden="true" class="octicon octicon-link"></span></a>Installation</h3>

<pre><code>npm install couchdb-promises
</code></pre>

<h3>
<a id="examplejs" class="anchor" href="#examplejs" aria-hidden="true"><span aria-hidden="true" class="octicon octicon-link"></span></a><a href="https://github.com/pmorjan/couchdb-promises/tree/master/examples/example.js">Example.js</a>
</h3>

<div class="highlight highlight-source-js"><pre><span class="pl-k">const</span> <span class="pl-c1">db</span> <span class="pl-k">=</span> <span class="pl-c1">require</span>(<span class="pl-s"><span class="pl-pds">'</span>couchdb-promises<span class="pl-pds">'</span></span>)
<span class="pl-k">const</span> <span class="pl-c1">baseUrl</span> <span class="pl-k">=</span> <span class="pl-s"><span class="pl-pds">'</span>http://localhost:5984<span class="pl-pds">'</span></span>  <span class="pl-c">// https://[user:password@]server[:port]</span>
<span class="pl-k">const</span> <span class="pl-c1">dbName</span> <span class="pl-k">=</span> <span class="pl-s"><span class="pl-pds">'</span>testdb<span class="pl-pds">'</span></span></pre></div>

<h4>
<a id="get-info" class="anchor" href="#get-info" aria-hidden="true"><span aria-hidden="true" class="octicon octicon-link"></span></a>get info</h4>

<div class="highlight highlight-source-js"><pre><span class="pl-smi">db</span>.<span class="pl-en">getInfo</span>(baseUrl)
.<span class="pl-en">then</span>(<span class="pl-en">console</span>.<span class="pl-smi">log</span>)
<span class="pl-c">// { headers: { ... },</span>
<span class="pl-c">//   data:</span>
<span class="pl-c">//    { couchdb: 'Welcome',</span>
<span class="pl-c">//      version: '2.0.0',</span>
<span class="pl-c">//      vendor: { name: 'The Apache Software Foundation' } },</span>
<span class="pl-c">//   status: 200,</span>
<span class="pl-c">//   message: 'OK - Request completed successfully'</span>
<span class="pl-c">//   duration: 36 }</span></pre></div>

<h4>
<a id="create-database" class="anchor" href="#create-database" aria-hidden="true"><span aria-hidden="true" class="octicon octicon-link"></span></a>create database</h4>

<div class="highlight highlight-source-js"><pre><span class="pl-smi">db</span>.<span class="pl-en">createDatabase</span>(baseUrl, dbName)
.<span class="pl-en">then</span>(<span class="pl-en">console</span>.<span class="pl-smi">log</span>)
<span class="pl-c">// { headers: { ... },</span>
<span class="pl-c">//   data: { ok: true },</span>
<span class="pl-c">//   status: 201,</span>
<span class="pl-c">//   message: 'Created - Database created successfully',</span>
<span class="pl-c">//   duration: 131 }</span></pre></div>

<h4>
<a id="get-database-head" class="anchor" href="#get-database-head" aria-hidden="true"><span aria-hidden="true" class="octicon octicon-link"></span></a>get database head</h4>

<div class="highlight highlight-source-js"><pre>.<span class="pl-en">then</span>(() <span class="pl-k">=&gt;</span> <span class="pl-smi">db</span>.<span class="pl-en">getDatabaseHead</span>(baseUrl, dbName))
.<span class="pl-en">then</span>(<span class="pl-en">console</span>.<span class="pl-smi">log</span>)
<span class="pl-c">// { headers: { ... },</span>
<span class="pl-c">//   data: {},</span>
<span class="pl-c">//   status: 200,</span>
<span class="pl-c">//   message: 'OK - Database exists',</span>
<span class="pl-c">//   duration: 4 }</span></pre></div>

<h4>
<a id="list-databases" class="anchor" href="#list-databases" aria-hidden="true"><span aria-hidden="true" class="octicon octicon-link"></span></a>list databases</h4>

<div class="highlight highlight-source-js"><pre>.<span class="pl-en">then</span>(() <span class="pl-k">=&gt;</span> <span class="pl-smi">db</span>.<span class="pl-en">listDatabases</span>(baseUrl))
.<span class="pl-en">then</span>(<span class="pl-en">console</span>.<span class="pl-smi">log</span>)
<span class="pl-c">// { headers: { ... },</span>
<span class="pl-c">//   data: [ '_replicator', '_users', 'testdb' ],</span>
<span class="pl-c">//   status: 200,</span>
<span class="pl-c">//   message: 'OK - Request completed successfully',</span>
<span class="pl-c">//   duration: 4 }</span></pre></div>

<h4>
<a id="create-document" class="anchor" href="#create-document" aria-hidden="true"><span aria-hidden="true" class="octicon octicon-link"></span></a>create document</h4>

<div class="highlight highlight-source-js"><pre>.<span class="pl-en">then</span>(() <span class="pl-k">=&gt;</span> <span class="pl-smi">db</span>.<span class="pl-c1">createDocument</span>(baseUrl, dbName, {name<span class="pl-k">:</span> <span class="pl-s"><span class="pl-pds">'</span>Bob<span class="pl-pds">'</span></span>}))
.<span class="pl-en">then</span>(<span class="pl-en">console</span>.<span class="pl-smi">log</span>)
<span class="pl-c">// { headers: { ... },</span>
<span class="pl-c">//   data:</span>
<span class="pl-c">//    { ok: true,</span>
<span class="pl-c">//      id: 'daae0752c6909d7ca4cd833f46014605',</span>
<span class="pl-c">//      rev: '1-5a26fa4b20e40bc9e2d3e47b168be460' },</span>
<span class="pl-c">//   status: 201,</span>
<span class="pl-c">//   message: 'Created – Document created and stored on disk',</span>
<span class="pl-c">//   duration: 42 }</span></pre></div>

<h4>
<a id="create-document-by-id" class="anchor" href="#create-document-by-id" aria-hidden="true"><span aria-hidden="true" class="octicon octicon-link"></span></a>create document by id</h4>

<div class="highlight highlight-source-js"><pre>.<span class="pl-en">then</span>(() <span class="pl-k">=&gt;</span> <span class="pl-smi">db</span>.<span class="pl-c1">createDocument</span>(baseUrl, dbName, {name<span class="pl-k">:</span> <span class="pl-s"><span class="pl-pds">'</span>Alice<span class="pl-pds">'</span></span>}, <span class="pl-s"><span class="pl-pds">'</span>doc2<span class="pl-pds">'</span></span>))
.<span class="pl-en">then</span>(<span class="pl-en">console</span>.<span class="pl-smi">log</span>)
<span class="pl-c">// { headers: { ... },</span>
<span class="pl-c">//   data:</span>
<span class="pl-c">//    { ok: true,</span>
<span class="pl-c">//      id: 'doc2',</span>
<span class="pl-c">//      rev: '1-88b10f13383b5d1e34d1d66d296f061f' },</span>
<span class="pl-c">//   status: 201,</span>
<span class="pl-c">//   message: 'Created – Document created and stored on disk',</span>
<span class="pl-c">//   duration: 38 }</span></pre></div>

<h4>
<a id="get-document-head" class="anchor" href="#get-document-head" aria-hidden="true"><span aria-hidden="true" class="octicon octicon-link"></span></a>get document head</h4>

<div class="highlight highlight-source-js"><pre>.<span class="pl-en">then</span>(() <span class="pl-k">=&gt;</span> <span class="pl-smi">db</span>.<span class="pl-en">getDocumentHead</span>(baseUrl, dbName, <span class="pl-s"><span class="pl-pds">'</span>doc2<span class="pl-pds">'</span></span>))
.<span class="pl-en">then</span>(<span class="pl-en">console</span>.<span class="pl-smi">log</span>)
<span class="pl-c">// { 'cache-control': 'must-revalidate',</span>
<span class="pl-c">//   connection: 'close',</span>
<span class="pl-c">//   'content-length': '74',</span>
<span class="pl-c">//   'content-type': 'application/json',</span>
<span class="pl-c">//   date: 'Sun, 06 Nov 2016 08:56:47 GMT',</span>
<span class="pl-c">//   etag: '"1-88b10f13383b5d1e34d1d66d296f061f"',</span>
<span class="pl-c">//   server: 'CouchDB/2.0.0 (Erlang OTP/17)',</span>
<span class="pl-c">//   'x-couch-request-id': '041e46071b',</span>
<span class="pl-c">//   'x-couchdb-body-time': '0' },</span>
<span class="pl-c">//   data: {},</span>
<span class="pl-c">//   status: 200,</span>
<span class="pl-c">//   message: 'OK - Document exists',</span>
<span class="pl-c">//   duration: 6 }</span></pre></div>

<h4>
<a id="get-document" class="anchor" href="#get-document" aria-hidden="true"><span aria-hidden="true" class="octicon octicon-link"></span></a>get document</h4>

<div class="highlight highlight-source-js"><pre>.<span class="pl-en">then</span>(() <span class="pl-k">=&gt;</span> <span class="pl-smi">db</span>.<span class="pl-en">getDocument</span>(baseUrl, dbName, <span class="pl-s"><span class="pl-pds">'</span>doc2<span class="pl-pds">'</span></span>))
.<span class="pl-en">then</span>(<span class="pl-smi">response</span> <span class="pl-k">=&gt;</span> { <span class="pl-en">console</span>.<span class="pl-c1">log</span>(response); <span class="pl-k">return</span> <span class="pl-smi">response</span>.<span class="pl-c1">data</span> })
<span class="pl-c">// { headers: { ... },</span>
<span class="pl-c">//   data:</span>
<span class="pl-c">//    { _id: 'doc2',</span>
<span class="pl-c">//      _rev: '1-88b10f13383b5d1e34d1d66d296f061f',</span>
<span class="pl-c">//      name: 'Alice' },</span>
<span class="pl-c">//   status: 200,</span>
<span class="pl-c">//   message: 'OK - Request completed successfully',</span>
<span class="pl-c">//   duration: 11 }</span></pre></div>

<h4>
<a id="update-document" class="anchor" href="#update-document" aria-hidden="true"><span aria-hidden="true" class="octicon octicon-link"></span></a>update document</h4>

<div class="highlight highlight-source-js"><pre>.<span class="pl-en">then</span>((<span class="pl-smi">doc</span>) <span class="pl-k">=&gt;</span> {
  <span class="pl-smi">doc</span>.<span class="pl-smi">age</span> <span class="pl-k">=</span> <span class="pl-c1">42</span>
  <span class="pl-k">return</span> <span class="pl-smi">db</span>.<span class="pl-c1">createDocument</span>(baseUrl, dbName, doc, <span class="pl-s"><span class="pl-pds">'</span>doc2<span class="pl-pds">'</span></span>)
})
.<span class="pl-en">then</span>(<span class="pl-en">console</span>.<span class="pl-smi">log</span>)
<span class="pl-c">// { headers: { ... },</span>
<span class="pl-c">//   data:</span>
<span class="pl-c">//    { ok: true,</span>
<span class="pl-c">//      id: 'doc2',</span>
<span class="pl-c">//      rev: '2-ee5ea9ac0bb1bec913a9b5e7bc11b113' },</span>
<span class="pl-c">//   status: 201,</span>
<span class="pl-c">//   message: 'Created – Document created and stored on disk',</span>
<span class="pl-c">//   duration: 36 }</span></pre></div>

<h4>
<a id="get-all-documents" class="anchor" href="#get-all-documents" aria-hidden="true"><span aria-hidden="true" class="octicon octicon-link"></span></a>get all documents</h4>

<div class="highlight highlight-source-js"><pre>.<span class="pl-en">then</span>(() <span class="pl-k">=&gt;</span> <span class="pl-smi">db</span>.<span class="pl-en">getAllDocuments</span>(baseUrl, dbName, {
  descending<span class="pl-k">:</span> <span class="pl-c1">true</span>,
  include_docs<span class="pl-k">:</span> <span class="pl-c1">true</span>
}))
.<span class="pl-en">then</span>(<span class="pl-en">console</span>.<span class="pl-smi">log</span>)
<span class="pl-c">// { headers: { ... },</span>
<span class="pl-c">//   data: { total_rows: 2, offset: 0, rows: [ [Object], [Object] ] },</span>
<span class="pl-c">//   status: 200,</span>
<span class="pl-c">//   message: 'OK - Request completed successfully',</span>
<span class="pl-c">//   duration: 9 }</span></pre></div>

<h4>
<a id="delete-document" class="anchor" href="#delete-document" aria-hidden="true"><span aria-hidden="true" class="octicon octicon-link"></span></a>delete document</h4>

<div class="highlight highlight-source-js"><pre>.<span class="pl-en">then</span>(() <span class="pl-k">=&gt;</span> <span class="pl-smi">db</span>.<span class="pl-en">deleteDocument</span>(baseUrl, dbName, <span class="pl-s"><span class="pl-pds">'</span>doc2<span class="pl-pds">'</span></span>, <span class="pl-s"><span class="pl-pds">'</span>2-ee5ea9ac0bb1bec913a9b5e7bc11b113<span class="pl-pds">'</span></span>))
.<span class="pl-en">then</span>(<span class="pl-en">console</span>.<span class="pl-smi">log</span>)
<span class="pl-c">// { headers: { ... },</span>
<span class="pl-c">//   data:</span>
<span class="pl-c">//    { ok: true,</span>
<span class="pl-c">//      id: 'doc2',</span>
<span class="pl-c">//      rev: '3-ec0a86a95c5e98a5cd52c29b79b66372' },</span>
<span class="pl-c">//   status: 200,</span>
<span class="pl-c">//   message: 'OK - Document successfully removed',</span>
<span class="pl-c">//   duration: 39 }</span></pre></div>

<h4>
<a id="bulk-create-documents" class="anchor" href="#bulk-create-documents" aria-hidden="true"><span aria-hidden="true" class="octicon octicon-link"></span></a>bulk create documents</h4>

<div class="highlight highlight-source-js"><pre>.<span class="pl-en">then</span>(() <span class="pl-k">=&gt;</span> <span class="pl-smi">db</span>.<span class="pl-en">createBulkDocuments</span>(baseUrl, dbName, [
  {name<span class="pl-k">:</span> <span class="pl-s"><span class="pl-pds">'</span>Tick<span class="pl-pds">'</span></span>}, {name<span class="pl-k">:</span> <span class="pl-s"><span class="pl-pds">'</span>Trick<span class="pl-pds">'</span></span>}, {name<span class="pl-k">:</span> <span class="pl-s"><span class="pl-pds">'</span>Track<span class="pl-pds">'</span></span>}
], {all_or_nothing<span class="pl-k">:</span> <span class="pl-c1">true</span>}))
.<span class="pl-en">then</span>(<span class="pl-en">console</span>.<span class="pl-smi">log</span>)
<span class="pl-c">// { headers: { ... },</span>
<span class="pl-c">//   data:</span>
<span class="pl-c">//   [ { ok: true,</span>
<span class="pl-c">//       id: '5413cf41edaedaec6b63aee93db86e1f',</span>
<span class="pl-c">//       rev: '1-d7f23e94e65978ea9252d753fe5dc3f6' },</span>
<span class="pl-c">//     { ok: true,</span>
<span class="pl-c">//       id: '5413cf41edaedaec6b63aee93db877cc',</span>
<span class="pl-c">//       rev: '1-646cd5f84634632f42fee2bdf4ff753a' },</span>
<span class="pl-c">//     { ok: true,</span>
<span class="pl-c">//       id: '5413cf41edaedaec6b63aee93db87c3d',</span>
<span class="pl-c">//       rev: '1-9cc8cf1e775b686ca337f69cd39ff772' } ],</span>
<span class="pl-c">//   status: 201,</span>
<span class="pl-c">//   message: 'Created – Document(s) have been created or updated',</span>
<span class="pl-c">//   duration: 74 }</span></pre></div>

<h4>
<a id="find-documents-requires-couchdb--200" class="anchor" href="#find-documents-requires-couchdb--200" aria-hidden="true"><span aria-hidden="true" class="octicon octicon-link"></span></a>find documents (requires CouchDB &gt;= 2.0.0)</h4>

<div class="highlight highlight-source-js"><pre>.<span class="pl-en">then</span>(() <span class="pl-k">=&gt;</span> <span class="pl-smi">db</span>.<span class="pl-en">findDocuments</span>(baseUrl, dbName, {
  selector<span class="pl-k">:</span> {
    $or<span class="pl-k">:</span> [{ name<span class="pl-k">:</span> <span class="pl-s"><span class="pl-pds">'</span>Tick<span class="pl-pds">'</span></span> }, {name<span class="pl-k">:</span> <span class="pl-s"><span class="pl-pds">'</span>Track<span class="pl-pds">'</span></span>}]
  },
  fields<span class="pl-k">:</span> [<span class="pl-s"><span class="pl-pds">'</span>_id<span class="pl-pds">'</span></span>, <span class="pl-s"><span class="pl-pds">'</span>name<span class="pl-pds">'</span></span>]
}))
.<span class="pl-en">then</span>(<span class="pl-en">console</span>.<span class="pl-smi">log</span>)
<span class="pl-c">// { headers: { ... },</span>
<span class="pl-c">//   data:</span>
<span class="pl-c">//    { warning: 'no matching index found, create an index to optimize query time',</span>
<span class="pl-c">//      docs: [ [Object], [Object] ] },</span>
<span class="pl-c">//   status: 200,</span>
<span class="pl-c">//   message: 'OK - Request completed successfully',</span>
<span class="pl-c">//   duration: 14 }</span></pre></div>

<h4>
<a id="get-uuids" class="anchor" href="#get-uuids" aria-hidden="true"><span aria-hidden="true" class="octicon octicon-link"></span></a>get uuids</h4>

<div class="highlight highlight-source-js"><pre>.<span class="pl-en">then</span>(() <span class="pl-k">=&gt;</span> <span class="pl-smi">db</span>.<span class="pl-en">getUuids</span>(baseUrl, <span class="pl-c1">3</span>))
.<span class="pl-en">then</span>(<span class="pl-en">console</span>.<span class="pl-smi">log</span>)
<span class="pl-c">// { headers: { ... },</span>
<span class="pl-c">//   data:</span>
<span class="pl-c">//    { uuids:</span>
<span class="pl-c">//       [ 'daae0752c6909d7ca4cd833f46014c47',</span>
<span class="pl-c">//         'daae0752c6909d7ca4cd833f460150c5',</span>
<span class="pl-c">//         'daae0752c6909d7ca4cd833f460156c5' ] },</span>
<span class="pl-c">//   status: 200,</span>
<span class="pl-c">//   message: 'OK - Request completed successfully',</span>
<span class="pl-c">//   duration: 4 }</span></pre></div>

<h4>
<a id="delete-database" class="anchor" href="#delete-database" aria-hidden="true"><span aria-hidden="true" class="octicon octicon-link"></span></a>delete database</h4>

<div class="highlight highlight-source-js"><pre>.<span class="pl-en">then</span>(() <span class="pl-k">=&gt;</span> <span class="pl-smi">db</span>.<span class="pl-en">deleteDatabase</span>(baseUrl, dbName))
.<span class="pl-en">then</span>(<span class="pl-en">console</span>.<span class="pl-smi">log</span>)
<span class="pl-c">// { headers: { ... },</span>
<span class="pl-c">//   data: { ok: true },</span>
<span class="pl-c">//   status: 200,</span>
<span class="pl-c">//   message: 'OK - Database removed successfully' }</span>
<span class="pl-c">//   duration: 40 }</span></pre></div>

<h4>
<a id="on-error" class="anchor" href="#on-error" aria-hidden="true"><span aria-hidden="true" class="octicon octicon-link"></span></a>on error</h4>

<div class="highlight highlight-source-js"><pre>.<span class="pl-en">then</span>(() <span class="pl-k">=&gt;</span> <span class="pl-smi">db</span>.<span class="pl-en">getDocument</span>(baseUrl, dbName, <span class="pl-s"><span class="pl-pds">'</span>doc1<span class="pl-pds">'</span></span>))
.<span class="pl-en">catch</span>(<span class="pl-en">console</span>.<span class="pl-smi">error</span>)
<span class="pl-c">// { headers: { ... },</span>
<span class="pl-c">//   data: { error: 'not_found', reason: 'Database does not exist.' },</span>
<span class="pl-c">//   status: 404,</span>
<span class="pl-c">//   message: 'Not Found - Document not found',</span>
<span class="pl-c">//   duration: 5 }</span></pre></div>

<hr>

<h3>
<a id="view-and-design-functions-viewjs" class="anchor" href="#view-and-design-functions-viewjs" aria-hidden="true"><span aria-hidden="true" class="octicon octicon-link"></span></a>View and Design Functions (<a href="https://github.com/pmorjan/couchdb-promises/tree/master/examples/view.js">View.js</a>)</h3>

<h4>
<a id="create-design-document" class="anchor" href="#create-design-document" aria-hidden="true"><span aria-hidden="true" class="octicon octicon-link"></span></a>create design document</h4>

<div class="highlight highlight-source-js"><pre><span class="pl-k">const</span> <span class="pl-c1">ddoc</span> <span class="pl-k">=</span> {
  language<span class="pl-k">:</span> <span class="pl-s"><span class="pl-pds">'</span>javascript<span class="pl-pds">'</span></span>,
  views<span class="pl-k">:</span> { view1<span class="pl-k">:</span> { map<span class="pl-k">:</span> <span class="pl-s"><span class="pl-pds">'</span>function (doc) {emit(doc.name, doc.number)}<span class="pl-pds">'</span></span> } }
}
<span class="pl-k">const</span> <span class="pl-c1">docId</span> <span class="pl-k">=</span> <span class="pl-s"><span class="pl-pds">'</span>ddoc1<span class="pl-pds">'</span></span>

<span class="pl-smi">db</span>.<span class="pl-en">createDesignDocument</span>(baseUrl, dbName, ddoc, docId)
.<span class="pl-en">then</span>(<span class="pl-en">console</span>.<span class="pl-smi">log</span>)
<span class="pl-c">// { headers: { ... },</span>
<span class="pl-c">//   data:</span>
<span class="pl-c">//    { ok: true,</span>
<span class="pl-c">//      id: '_design/ddoc1',</span>
<span class="pl-c">//      rev: '1-548c68d8cc2c1fac99964990a58f66fd' },</span>
<span class="pl-c">//   status: 201,</span>
<span class="pl-c">//   message: 'Created – Document created and stored on disk',</span>
<span class="pl-c">//   duration: 271 }</span></pre></div>

<h4>
<a id="get-design-document" class="anchor" href="#get-design-document" aria-hidden="true"><span aria-hidden="true" class="octicon octicon-link"></span></a>get design document</h4>

<div class="highlight highlight-source-js"><pre><span class="pl-smi">db</span>.<span class="pl-en">getDesignDocument</span>(baseUrl, dbName, docId)
.<span class="pl-en">then</span>(<span class="pl-en">console</span>.<span class="pl-smi">log</span>)
<span class="pl-c">// { headers: { ... },</span>
<span class="pl-c">//   data:</span>
<span class="pl-c">//    { _id: '_design/ddoc1',</span>
<span class="pl-c">//      _rev: '1-548c68d8cc2c1fac99964990a58f66fd',</span>
<span class="pl-c">//      language: 'javascript',</span>
<span class="pl-c">//      views: { view1: [Object] } },</span>
<span class="pl-c">//   status: 200,</span>
<span class="pl-c">//   message: 'OK - Request completed successfully',</span>
<span class="pl-c">//   duration: 5 }</span></pre></div>

<h4>
<a id="get-design-document-info" class="anchor" href="#get-design-document-info" aria-hidden="true"><span aria-hidden="true" class="octicon octicon-link"></span></a>get design document info</h4>

<div class="highlight highlight-source-js"><pre><span class="pl-smi">db</span>.<span class="pl-en">getDesignDocumentInfo</span>(baseUrl, dbName, docId)
.<span class="pl-en">then</span>(<span class="pl-en">console</span>.<span class="pl-smi">log</span>)
<span class="pl-c">// { headers: { ... },</span>
<span class="pl-c">//   data:</span>
<span class="pl-c">//   { name: 'ddoc1',</span>
<span class="pl-c">//     view_index:</span>
<span class="pl-c">//      { updates_pending: [Object],</span>
<span class="pl-c">//        waiting_commit: false,</span>
<span class="pl-c">//        waiting_clients: 0,</span>
<span class="pl-c">//        updater_running: false,</span>
<span class="pl-c">//        update_seq: 0,</span>
<span class="pl-c">//        sizes: [Object],</span>
<span class="pl-c">//        signature: '1e86d92af43c47ef58da4b645dbd47f1',</span>
<span class="pl-c">//        purge_seq: 0,</span>
<span class="pl-c">//        language: 'javascript',</span>
<span class="pl-c">//        disk_size: 408,</span>
<span class="pl-c">//        data_size: 0,</span>
<span class="pl-c">//        compact_running: false } },</span>
<span class="pl-c">//   status: 200,</span>
<span class="pl-c">//   message: 'OK - Request completed successfully',</span>
<span class="pl-c">//   duration: 54 }</span></pre></div>

<h4>
<a id="get-view" class="anchor" href="#get-view" aria-hidden="true"><span aria-hidden="true" class="octicon octicon-link"></span></a>get view</h4>

<div class="highlight highlight-source-js"><pre><span class="pl-smi">db</span>.<span class="pl-en">getView</span>(baseUrl, dbName, docId, viewName, {limit<span class="pl-k">:</span> <span class="pl-c1">3</span>})
.<span class="pl-en">then</span>(<span class="pl-en">console</span>.<span class="pl-smi">log</span>)
<span class="pl-c">// { headers: { ... },</span>
<span class="pl-c">//   data:</span>
<span class="pl-c">//    { total_rows: 12,</span>
<span class="pl-c">//      offset: 0,</span>
<span class="pl-c">//      rows: [ [Object], [Object], [Object] ] },</span>
<span class="pl-c">//   status: 200,</span>
<span class="pl-c">//   message: 'OK - Request completed successfully',</span>
<span class="pl-c">//   duration: 834 }</span></pre></div>

<h4>
<a id="delete-design-document" class="anchor" href="#delete-design-document" aria-hidden="true"><span aria-hidden="true" class="octicon octicon-link"></span></a>delete design document</h4>

<div class="highlight highlight-source-js"><pre><span class="pl-smi">db</span>.<span class="pl-en">deleteDesignDocument</span>(baseUrl, dbName, docId, rev)
.<span class="pl-en">then</span>(<span class="pl-en">console</span>.<span class="pl-smi">log</span>)
<span class="pl-c">// { headers: { ... },</span>
<span class="pl-c">//   data:</span>
<span class="pl-c">//    { ok: true,</span>
<span class="pl-c">//      id: '_design/ddoc1',</span>
<span class="pl-c">//      rev: '2-fd68157ec3c1915ebe0b248343292d34' },</span>
<span class="pl-c">//   status: 200,</span>
<span class="pl-c">//   message: 'OK - Document successfully removed',</span>
<span class="pl-c">//   duration: 49 }</span></pre></div>

<hr>

<h3>
<a id="index-functions-couchdb--20" class="anchor" href="#index-functions-couchdb--20" aria-hidden="true"><span aria-hidden="true" class="octicon octicon-link"></span></a>Index Functions (CouchDB &gt;= 2.0)</h3>

<h3>
<a id="create-index" class="anchor" href="#create-index" aria-hidden="true"><span aria-hidden="true" class="octicon octicon-link"></span></a>create index</h3>

<div class="highlight highlight-source-js"><pre><span class="pl-smi">db</span>.<span class="pl-en">createIndex</span>(baseUrl, dbName, {
  index<span class="pl-k">:</span> {
    fields<span class="pl-k">:</span> [<span class="pl-s"><span class="pl-pds">'</span>foo<span class="pl-pds">'</span></span>]
  },
  name<span class="pl-k">:</span> <span class="pl-s"><span class="pl-pds">'</span>foo-index<span class="pl-pds">'</span></span>
})
.<span class="pl-en">then</span>(<span class="pl-en">console</span>.<span class="pl-smi">log</span>)
<span class="pl-c">// { headers: { ... },</span>
<span class="pl-c">//   data:</span>
<span class="pl-c">//    { result: 'exists',</span>
<span class="pl-c">//      id: '_design/a5f4711fc9448864a13c81dc71e660b524d7410c',</span>
<span class="pl-c">//      name: 'foo-index' },</span>
<span class="pl-c">//   status: 200,</span>
<span class="pl-c">//   message: 'OK - Index created successfully or already exists',</span>
<span class="pl-c">//   duration: 14 }</span></pre></div>

<h3>
<a id="get-index" class="anchor" href="#get-index" aria-hidden="true"><span aria-hidden="true" class="octicon octicon-link"></span></a>get index</h3>

<div class="highlight highlight-source-js"><pre><span class="pl-smi">db</span>.<span class="pl-en">getIndex</span>(baseUrl, dbName)
.<span class="pl-en">then</span>(<span class="pl-en">console</span>.<span class="pl-smi">log</span>)
<span class="pl-c">// { headers: { ... },</span>
<span class="pl-c">//   data: { total_rows: 2, indexes: [ [Object], [Object] ] },</span>
<span class="pl-c">//   status: 200,</span>
<span class="pl-c">//   message: 'OK - Success',</span>
<span class="pl-c">//   duration: 6 }</span></pre></div>

<h3>
<a id="delete-index" class="anchor" href="#delete-index" aria-hidden="true"><span aria-hidden="true" class="octicon octicon-link"></span></a>delete index</h3>

<div class="highlight highlight-source-js"><pre><span class="pl-smi">db</span>.<span class="pl-en">getIndex</span>(baseUrl, dbName)
.<span class="pl-en">then</span>(<span class="pl-smi">response</span> <span class="pl-k">=&gt;</span> {
  <span class="pl-k">const</span> <span class="pl-c1">docId</span> <span class="pl-k">=</span> <span class="pl-smi">response</span>.<span class="pl-c1">data</span>.<span class="pl-smi">indexes</span>.<span class="pl-c1">find</span>(<span class="pl-smi">e</span> <span class="pl-k">=&gt;</span> <span class="pl-smi">e</span>.<span class="pl-c1">name</span> <span class="pl-k">===</span> <span class="pl-s"><span class="pl-pds">'</span>foo-index<span class="pl-pds">'</span></span>).<span class="pl-smi">ddoc</span>
  <span class="pl-k">return</span> <span class="pl-smi">db</span>.<span class="pl-en">deleteIndex</span>(baseUrl, dbName, docId, <span class="pl-s"><span class="pl-pds">'</span>foo-index<span class="pl-pds">'</span></span>)
})
.<span class="pl-en">then</span>(<span class="pl-en">console</span>.<span class="pl-smi">log</span>)
<span class="pl-c">// { headers: { ... },</span>
<span class="pl-c">//  data: { ok: true },</span>
<span class="pl-c">//  status: 200,</span>
<span class="pl-c">//  message: 'OK - Success',</span>
<span class="pl-c">//  duration: 45 }</span></pre></div>

<hr>

<h4>
<a id="get-request-timeout" class="anchor" href="#get-request-timeout" aria-hidden="true"><span aria-hidden="true" class="octicon octicon-link"></span></a>get request timeout</h4>

<div class="highlight highlight-source-js"><pre><span class="pl-smi">db</span>.<span class="pl-en">getTimeout</span>()
<span class="pl-c">// -&gt; 10000  (returns Number)</span></pre></div>

<h4>
<a id="set-request-timeout" class="anchor" href="#set-request-timeout" aria-hidden="true"><span aria-hidden="true" class="octicon octicon-link"></span></a>set request timeout</h4>

<div class="highlight highlight-source-js"><pre><span class="pl-smi">db</span>.<span class="pl-en">setTimeout</span>(<span class="pl-c1">3000</span>)
<span class="pl-c">// -&gt; 3000  (returns Number)</span></pre></div>

<hr>

<h1>
<a id="api-reference" class="anchor" href="#api-reference" aria-hidden="true"><span aria-hidden="true" class="octicon octicon-link"></span></a>API Reference</h1>

<p>See <a href="https://github.com/pmorjan/couchdb-promises/tree/master/examples/">examples</a> for details.</p>

<h3>
<a id="database-functions" class="anchor" href="#database-functions" aria-hidden="true"><span aria-hidden="true" class="octicon octicon-link"></span></a>database functions</h3>

<ul>
<li>  createDatabase()</li>
<li>  deleteDatabase()</li>
<li>  findDocuments()</li>
<li>  getDatabase()</li>
<li>  getDatabaseHead()</li>
<li>  listDatabases()</li>
</ul>

<h3>
<a id="document-functions" class="anchor" href="#document-functions" aria-hidden="true"><span aria-hidden="true" class="octicon octicon-link"></span></a>document functions</h3>

<ul>
<li>  getAllDocuments()</li>
<li>  createDocument()</li>
<li>  deleteDocument()</li>
<li>  getDocument()</li>
<li>  getDocumentHead()</li>
</ul>

<h3>
<a id="index-functions-couchdb--20-1" class="anchor" href="#index-functions-couchdb--20-1" aria-hidden="true"><span aria-hidden="true" class="octicon octicon-link"></span></a>index functions (CouchDB &gt;= 2.0)</h3>

<ul>
<li>  createIndex()</li>
<li>  getIndex()</li>
<li>  deleteIndex()</li>
</ul>

<h3>
<a id="document-attachment-functions" class="anchor" href="#document-attachment-functions" aria-hidden="true"><span aria-hidden="true" class="octicon octicon-link"></span></a>document attachment functions</h3>

<ul>
<li>  getAttachment()</li>
<li>  getAttachmentHead()</li>
<li>  addAttachment()</li>
<li>  deleteAttachment()</li>
</ul>

<h3>
<a id="view-and-design-document-functions" class="anchor" href="#view-and-design-document-functions" aria-hidden="true"><span aria-hidden="true" class="octicon octicon-link"></span></a>view and design document functions</h3>

<ul>
<li>  createDesignDocument()</li>
<li>  deleteDesignDocument()</li>
<li>  getDesignDocument()</li>
<li>  getDesignDocumentInfo()</li>
<li>  getView()</li>
</ul>

<h3>
<a id="bulk-document-functions" class="anchor" href="#bulk-document-functions" aria-hidden="true"><span aria-hidden="true" class="octicon octicon-link"></span></a>bulk document functions</h3>

<ul>
<li>  createBulkDocuments()</li>
</ul>

<h3>
<a id="miscellaneous-functions" class="anchor" href="#miscellaneous-functions" aria-hidden="true"><span aria-hidden="true" class="octicon octicon-link"></span></a>miscellaneous functions</h3>

<ul>
<li>  setTimeout()</li>
<li>  getTimeout()</li>
<li>  getInfo()</li>
<li>  getUuids()</li>
</ul>

<h3>
<a id="aliases-for-backward-compatibility" class="anchor" href="#aliases-for-backward-compatibility" aria-hidden="true"><span aria-hidden="true" class="octicon octicon-link"></span></a>aliases for backward compatibility</h3>

<ul>
<li>  bulkDocs() -&gt; createBulkDocuments()</li>
<li>  getAllDocs() -&gt; getAllDocuments()</li>
</ul>

      <footer class="site-footer">
        <span class="site-footer-owner"><a href="https://github.com/pmorjan/couchdb-promises">Couchdb-promises</a> is maintained by <a href="https://github.com/pmorjan">pmorjan</a>.</span>

        <span class="site-footer-credits">This page was generated by <a href="https://pages.github.com">GitHub Pages</a> using the <a href="https://github.com/jasonlong/cayman-theme">Cayman theme</a> by <a href="https://twitter.com/jasonlong">Jason Long</a>.</span>
      </footer>

    </section>

  
  </body>
</html>
